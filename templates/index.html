<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WiFi Hotspot Manager - Orange Pi</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-title">
                    <i data-lucide="wifi" style="color: #667eea; width: 32px; height: 32px;"></i>
                    <h1>WiFi Hotspot Manager</h1>
                </div>
                <div id="statusBadge" class="status-badge status-inactive">
                    <span class="status-dot"></span>
                    <span>Inactive</span>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div id="statsGrid" class="stats-grid" style="display: none;">
            <div class="stat-card blue">
                <div class="stat-header">
                    <i data-lucide="activity" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">UPTIME</span>
                </div>
                <div class="stat-value" id="uptime">0h 0m 0s</div>
            </div>
            <div class="stat-card green">
                <div class="stat-header">
                    <i data-lucide="users" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">CLIENTS</span>
                </div>
                <div class="stat-value" id="clientCount">0</div>
            </div>
            <div class="stat-card purple">
                <div class="stat-header">
                    <i data-lucide="arrow-up" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">TX RATE</span>
                </div>
                <div class="stat-value" id="txRate">0 B/s</div>
            </div>
            <div class="stat-card orange">
                <div class="stat-header">
                    <i data-lucide="arrow-down" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">RX RATE</span>
                </div>
                <div class="stat-value" id="rxRate">0 B/s</div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Configuration Panel -->
            <div class="panel">
                <div class="panel-header">
                    <i data-lucide="settings" style="color: #667eea; width: 24px; height: 24px;"></i>
                    <h2>Configuration</h2>
                </div>

                <form id="configForm">
                    <!-- Basic Settings -->
                    <div class="section-title">Basic Settings</div>
                    
                    <div class="form-group">
                        <label class="form-label">WiFi Interface</label>
                        <select id="wifiInterface" class="form-select">
                            <option value="wlan0">wlan0</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Internet Interface</label>
                        <select id="internetInterface" class="form-select">
                            <option value="eth0">eth0</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">SSID (Network Name)</label>
                        <input type="text" id="ssid" class="form-input" value="OrangePi-Hotspot" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Password (min 8 chars or empty for open)</label>
                        <input type="password" id="password" class="form-input" placeholder="Leave empty for open network">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">WPA Version</label>
                            <select id="wpaVersion" class="form-select">
                                <option value="2">WPA2</option>
                                <option value="1">WPA</option>
                                <option value="3">WPA3 (SAE)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Frequency Band</label>
                            <select id="freqBand" class="form-select">
                                <option value="2.4">2.4 GHz</option>
                                <option value="5">5 GHz</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Channel</label>
                            <select id="channel" class="form-select">
                                <!-- Options will be populated by JavaScript -->
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Country Code</label>
                            <input type="text" id="country" class="form-input" placeholder="US, VN, etc." maxlength="2" value="US">
                        </div>
                    </div>

                    <!-- WiFi Standards Section -->
                    <div class="section-title" style="margin-top: 20px;">WiFi Standards</div>
                    
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="ieee80211n" checked>
                            <span><strong>Enable IEEE 802.11n (WiFi 4)</strong> - Up to 600 Mbps, 2.4/5 GHz</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ieee80211ac" checked>
                            <span><strong>Enable IEEE 802.11ac (WiFi 5)</strong> - Up to 3.5 Gbps, 5 GHz only</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="ieee80211ax">
                            <span><strong>Enable IEEE 802.11ax (WiFi 6)</strong> - Up to 9.6 Gbps, 2.4/5/6 GHz</span>
                        </label>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="section-title" style="margin-top: 20px;">
                        <span>Advanced Settings</span>
                        <button type="button" id="toggleAdvanced" class="btn-link">Show</button>
                    </div>

                    <div id="advancedSettings" style="display: none;">
                        <!-- Network Settings -->
                        <div class="subsection-title">Network Settings</div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Gateway IP</label>
                                <input type="text" id="gateway" class="form-input" placeholder="192.168.12.1" value="192.168.12.1">
                            </div>
                            <div class="form-group">
                                <label class="form-label">DNS Servers</label>
                                <input type="text" id="dhcpDns" class="form-input" placeholder="8.8.8.8,8.8.4.4" value="8.8.8.8,8.8.4.4">
                            </div>
                        </div>

                        <!-- DHCP Settings -->
                        <div class="subsection-title" style="margin-top: 16px;">DHCP Settings</div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">DHCP Start IP</label>
                                <input type="text" id="dhcpStart" class="form-input" placeholder="192.168.12.10" value="192.168.12.10">
                            </div>
                            <div class="form-group">
                                <label class="form-label">DHCP End IP</label>
                                <input type="text" id="dhcpEnd" class="form-input" placeholder="192.168.12.100" value="192.168.12.100">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Lease Time</label>
                                <input type="text" id="leaseTime" class="form-input" placeholder="12h" value="12h">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Max Stations</label>
                                <input type="number" id="maxStations" class="form-input" placeholder="50" value="50">
                            </div>
                        </div>

                        <!-- Advanced WiFi Capabilities -->
                        <div class="subsection-title" style="margin-top: 16px;">
                            <span>Advanced WiFi Capabilities</span>
                            <button type="button" id="toggleWifiCapab" class="btn-link-small">Show</button>
                        </div>

                        <div id="wifiCapabSettings" style="display: none; margin-top: 12px;">
                            <div class="form-group">
                                <label class="form-label">
                                    HT Capabilities (802.11n)
                                    <span style="font-size: 12px; color: #718096; font-weight: normal;">
                                        - Leave empty for auto-detect
                                    </span>
                                </label>
                                <input type="text" id="htCapab" class="form-input" placeholder="e.g., [HT40+][SHORT-GI-20][SHORT-GI-40]">
                                <div style="font-size: 11px; color: #a0aec0; margin-top: 4px;">
                                    Common: [HT40+] [HT40-] [SHORT-GI-20] [SHORT-GI-40] [DSSS_CCK-40]
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    VHT Capabilities (802.11ac)
                                    <span style="font-size: 12px; color: #718096; font-weight: normal;">
                                        - Leave empty for auto-detect
                                    </span>
                                </label>
                                <input type="text" id="vhtCapab" class="form-input" placeholder="e.g., [MAX-MPDU-11454][SHORT-GI-80]">
                                <div style="font-size: 11px; color: #a0aec0; margin-top: 4px;">
                                    Common: [MAX-MPDU-11454] [SHORT-GI-80] [TX-STBC-2BY1] [RX-STBC-1]
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    HE Capabilities (802.11ax)
                                    <span style="font-size: 12px; color: #718096; font-weight: normal;">
                                        - Leave empty for auto-detect
                                    </span>
                                </label>
                                <input type="text" id="heCapab" class="form-input" placeholder="e.g., [HE80]">
                                <div style="font-size: 11px; color: #a0aec0; margin-top: 4px;">
                                    Common: [HE80] [HE160] [HE-SU-BEAMFORMER] [HE-MU-BEAMFORMER]
                                </div>
                            </div>
                        </div>

                        <!-- Security & Access Control -->
                        <div class="subsection-title" style="margin-top: 16px;">Security & Access Control</div>

                        <div class="form-group">
                            <label class="form-label">MAC Filter Accept File</label>
                            <input type="text" id="macFilterAccept" class="form-input" placeholder="/etc/hostapd/hostapd.accept">
                        </div>

                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="hidden">
                                <span>Hidden Network (don't broadcast SSID)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="isolate">
                                <span>Client Isolation (prevent client-to-client communication)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="macFilter">
                                <span>Enable MAC Address Filtering</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="psk">
                                <span>Use PSK (64 hex digits pre-shared key)</span>
                            </label>
                        </div>

                        <!-- System Options -->
                        <div class="subsection-title" style="margin-top: 16px;">System Options</div>

                        <div class="form-group">
                            <label class="form-label">Driver</label>
                            <input type="text" id="driver" class="form-input" placeholder="nl80211 (default)" value="nl80211">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Additional Hosts File</label>
                            <input type="text" id="hostsFile" class="form-input" placeholder="/etc/hosts.custom">
                        </div>

                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="noInternet">
                                <span>Disable Internet Sharing (isolated network)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="noDns">
                                <span>Disable DNS Server</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="noDnsmasq">
                                <span>Disable DHCP/DNS Completely</span>
                            </label>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="form-group" style="margin-top: 24px;">
                        <button type="button" id="viewConfig" class="btn btn-secondary" style="margin-bottom: 12px;">
                            <i data-lucide="file-text" style="width: 18px; height: 18px;"></i>
                            <span>View hostapd.conf</span>
                        </button>
                        <button type="button" id="loadLastConfig" class="btn btn-secondary" style="margin-bottom: 12px;">
                            <i data-lucide="rotate-ccw" style="width: 18px; height: 18px;"></i>
                            <span>Load Last Config</span>
                        </button>
                        <button type="button" id="startBtn" class="btn btn-primary">
                            <i data-lucide="play" style="width: 18px; height: 18px;"></i>
                            <span>Start Hotspot</span>
                        </button>
                        <button type="button" id="stopBtn" class="btn btn-danger" style="display: none; margin-top: 12px;">
                            <i data-lucide="square" style="width: 18px; height: 18px;"></i>
                            <span>Stop Hotspot</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Right Column -->
            <div style="display: flex; flex-direction: column; gap: 24px;">
                <!-- Current Configuration -->
                <div class="panel" id="currentConfigPanel" style="display: none;">
                    <div class="panel-header">
                        <i data-lucide="info" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Current Configuration</h2>
                    </div>
                    <div class="config-display">
                        <div class="config-item">
                            <span class="config-label">SSID:</span>
                            <span class="config-value" id="currentSsid">-</span>
                        </div>
                        <div class="config-item">
                            <span class="config-label">WiFi Standard:</span>
                            <span class="config-value" id="currentStandard">-</span>
                        </div>
                        <div class="config-item">
                            <span class="config-label">Frequency:</span>
                            <span class="config-value" id="currentFreq">-</span>
                        </div>
                        <div class="config-item">
                            <span class="config-label">Channel:</span>
                            <span class="config-value" id="currentChannel">-</span>
                        </div>
                        <div class="config-item">
                            <span class="config-label">Security:</span>
                            <span class="config-value" id="currentSecurity">-</span>
                        </div>
                    </div>
                </div>

                <!-- Connected Clients -->
                <div class="panel" id="clientsPanel" style="display: none;">
                    <div class="panel-header">
                        <i data-lucide="users" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Connected Clients</h2>
                    </div>
                    <div class="client-list" id="clientList">
                        <div class="empty-state">
                            <i data-lucide="wifi-off" style="width: 48px; height: 48px; margin: 0 auto 12px;"></i>
                            <p>No clients connected yet</p>
                        </div>
                    </div>
                </div>

                <!-- Traffic Statistics -->
                <div class="panel" id="trafficPanel" style="display: none;">
                    <div class="panel-header">
                        <i data-lucide="bar-chart-2" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Traffic Statistics</h2>
                    </div>
                    <table class="stats-table">
                        <tr>
                            <td>WiFi Transmitted:</td>
                            <td id="wifiTx">0 B</td>
                        </tr>
                        <tr>
                            <td>WiFi Received:</td>
                            <td id="wifiRx">0 B</td>
                        </tr>
                        <tr>
                            <td>Internet Transmitted:</td>
                            <td id="ethTx">0 B</td>
                        </tr>
                        <tr>
                            <td>Internet Received:</td>
                            <td id="ethRx">0 B</td>
                        </tr>
                        <tr>
                            <td><strong>Total Traffic:</strong></td>
                            <td class="stats-total" id="totalTraffic">0 B</td>
                        </tr>
                    </table>
                </div>

                <!-- Logs -->
                <div class="panel">
                    <div class="panel-header">
                        <i data-lucide="scroll-text" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Logs</h2>
                    </div>
                    <div class="logs-container" id="logsContainer">
                        <div style="color: #718096;">Initializing...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Box -->
        <div class="info-box">
            <p><strong>üí° WiFi Standards Guide:</strong></p>
            <ul style="margin-top: 8px; padding-left: 20px; line-height: 1.8;">
                <li><strong>802.11n (WiFi 4):</strong> Up to 600 Mbps, works on both 2.4 GHz and 5 GHz</li>
                <li><strong>802.11ac (WiFi 5):</strong> Up to 3.5 Gbps, requires 5 GHz band</li>
                <li><strong>802.11ax (WiFi 6):</strong> Up to 9.6 Gbps, works on 2.4/5/6 GHz (requires compatible hardware)</li>
                <li><strong>Recommended:</strong> Enable 802.11n + 802.11ac for best compatibility and performance on 5 GHz</li>
                <li><strong>Country Code:</strong> Set your country (e.g., US, VN, GB) for proper regulatory compliance</li>
            </ul>
            
            <p style="margin-top: 12px;"><strong>‚öôÔ∏è System Requirements:</strong></p>
            <ul style="margin-top: 8px; padding-left: 20px; line-height: 1.8;">
                <li>Run with <strong>sudo</strong> (root privileges required)</li>
                <li>Requires <strong>hostapd</strong> and <strong>dnsmasq</strong> installed</li>
                <li>Configuration is <strong>automatically saved</strong> and restored on restart</li>
                <li>WiFi interface must support <strong>AP mode</strong></li>
            </ul>

            <p style="margin-top: 12px;"><strong>üîß Installation:</strong></p>
            <div style="background: #1a202c; color: #68d391; padding: 12px; border-radius: 8px; margin-top: 8px; font-family: monospace; font-size: 13px;">
                sudo apt update<br>
                sudo apt install hostapd dnsmasq python3-pip<br>
                sudo systemctl stop hostapd dnsmasq<br>
                sudo systemctl disable hostapd dnsmasq<br>
                pip3 install flask psutil
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>