<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WiFi Hotspot Manager - Orange Pi</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="header-title">
                    <i data-lucide="wifi" style="color: #667eea; width: 32px; height: 32px;"></i>
                    <h1>WiFi Hotspot Manager</h1>
                </div>
                <div id="statusBadge" class="status-badge status-inactive">
                    <span class="status-dot"></span>
                    <span>Inactive</span>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div id="statsGrid" class="stats-grid" style="display: none;">
            <div class="stat-card blue">
                <div class="stat-header">
                    <i data-lucide="activity" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">UPTIME</span>
                </div>
                <div class="stat-value" id="uptime">0h 0m 0s</div>
            </div>
            <div class="stat-card green">
                <div class="stat-header">
                    <i data-lucide="users" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">CLIENTS</span>
                </div>
                <div class="stat-value" id="clientCount">0</div>
            </div>
            <div class="stat-card purple">
                <div class="stat-header">
                    <i data-lucide="arrow-up" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">TX RATE</span>
                </div>
                <div class="stat-value" id="txRate">0 B/s</div>
            </div>
            <div class="stat-card orange">
                <div class="stat-header">
                    <i data-lucide="arrow-down" style="width: 20px; height: 20px;"></i>
                    <span class="stat-label">RX RATE</span>
                </div>
                <div class="stat-value" id="rxRate">0 B/s</div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Configuration Panel -->
            <div class="panel">
                <div class="panel-header">
                    <i data-lucide="settings" style="color: #667eea; width: 24px; height: 24px;"></i>
                    <h2>Configuration</h2>
                </div>

                <form id="configForm">
                    <!-- Basic Settings -->
                    <div class="section-title">Basic Settings</div>
                    
                    <div class="form-group">
                        <label class="form-label">WiFi Interface</label>
                        <select id="wifiInterface" class="form-select">
                            <option value="wlan0">wlan0</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Internet Interface</label>
                        <select id="internetInterface" class="form-select">
                            <option value="eth0">eth0</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">SSID (Network Name)</label>
                        <input type="text" id="ssid" class="form-input" value="OrangePi-Hotspot" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Password (min 8 chars or empty for open)</label>
                        <input type="password" id="password" class="form-input" placeholder="Leave empty for open network">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">WPA Version</label>
                            <select id="wpaVersion" class="form-select">
                                <option value="1+2">WPA/WPA2 (1+2)</option>
                                <option value="2">WPA2 only</option>
                                <option value="1">WPA only</option>
                            </select>
                        </div>

						<div class="form-group">
							<label class="form-label">Channel</label>
							<select id="channel" class="form-select">
								<!-- Options will be populated by JavaScript based on frequency band -->
							</select>
						</div>
                    </div>

                    <!-- Advanced Settings -->
                    <div class="section-title" style="margin-top: 20px;">
                        <span>Advanced Settings</span>
                        <button type="button" id="toggleAdvanced" class="btn-link">Show</button>
                    </div>

                    <div id="advancedSettings" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Sharing Method</label>
                                <select id="method" class="form-select">
                                    <option value="nat">NAT (default)</option>
                                    <option value="bridge">Bridge</option>
                                    <option value="none">None</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Frequency Band</label>
                                <select id="freqBand" class="form-select">
                                    <option value="2.4">2.4 GHz</option>
                                    <option value="5">5 GHz</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Country Code</label>
                                <input type="text" id="country" class="form-input" placeholder="US, VN, etc." maxlength="2">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Gateway IP</label>
                                <input type="text" id="gateway" class="form-input" placeholder="192.168.12.1">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">DHCP DNS</label>
                                <input type="text" id="dhcpDns" class="form-input" placeholder="8.8.8.8,8.8.4.4">
                            </div>

                            <div class="form-group">
                                <label class="form-label">MAC Address</label>
                                <input type="text" id="mac" class="form-input" placeholder="00:11:22:33:44:55">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Driver</label>
                                <input type="text" id="driver" class="form-input" placeholder="nl80211 (default)">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Hostapd Debug</label>
                                <select id="hostapdDebug" class="form-select">
                                    <option value="">None</option>
                                    <option value="1">Level 1</option>
                                    <option value="2">Level 2</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">HT Capabilities</label>
                            <input type="text" id="htCapab" class="form-input" placeholder="[HT40+]">
                        </div>

                        <div class="form-group">
                            <label class="form-label">VHT Capabilities</label>
                            <input type="text" id="vhtCapab" class="form-input" placeholder="[VHT160]">
                        </div>

                        <div class="form-group">
                            <label class="form-label">MAC Filter Accept File</label>
                            <input type="text" id="macFilterAccept" class="form-input" placeholder="/etc/hostapd/hostapd.accept">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Additional Hosts File</label>
                            <input type="text" id="hostsFile" class="form-input" placeholder="/etc/hosts.custom">
                        </div>

                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="hidden">
                                <span>Hidden Network (don't broadcast SSID)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="isolate">
                                <span>Isolate Clients (prevent client-to-client communication)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="noVirt">
                                <span>No Virtual Interface (use physical interface directly)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="ieee80211n">
                                <span>Enable IEEE 802.11n (HT mode)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="ieee80211ac">
                                <span>Enable IEEE 802.11ac (VHT mode)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="macFilter">
                                <span>Enable MAC Address Filtering</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="redirectToLocalhost">
                                <span>Redirect to Localhost (for captive portal)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="noInternet">
                                <span>Disable Internet Sharing</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="noDns">
                                <span>Disable DNS Server</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="noDnsmasq">
                                <span>Disable Dnsmasq Completely</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="dnsHosts">
                                <span>Use /etc/hosts for DNS</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="noHaveged">
                                <span>Don't Run Haveged</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="fixUnmanaged">
                                <span>Fix Unmanaged Interface After Stop</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="psk">
                                <span>Use PSK (64 hex digits pre-shared key)</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" id="daemon">
                                <span>Run in Daemon Mode (background)</span>
                            </label>
                        </div>

                        <div id="daemonOptions" style="display: none; margin-top: 12px;">
                            <div class="form-group">
                                <label class="form-label">PID File</label>
                                <input type="text" id="pidfile" class="form-input" placeholder="/var/run/create_ap.pid">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Log File</label>
                                <input type="text" id="logfile" class="form-input" placeholder="/var/log/create_ap.log">
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="form-group" style="margin-top: 24px;">
                        <button type="button" id="loadLastConfig" class="btn btn-secondary" style="margin-bottom: 12px;">
                            <i data-lucide="rotate-ccw" style="width: 18px; height: 18px;"></i>
                            <span>Load Last Config</span>
                        </button>
                        <button type="button" id="startBtn" class="btn btn-primary">
                            <i data-lucide="play" style="width: 18px; height: 18px;"></i>
                            <span>Start Hotspot</span>
                        </button>
                        <button type="button" id="stopBtn" class="btn btn-danger" style="display: none; margin-top: 12px;">
                            <i data-lucide="square" style="width: 18px; height: 18px;"></i>
                            <span>Stop Hotspot</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Right Column -->
            <div style="display: flex; flex-direction: column; gap: 24px;">
                <!-- Command Preview -->
                <div class="panel">
                    <div class="panel-header">
                        <i data-lucide="terminal" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Command Preview</h2>
                    </div>
                    <div class="command-preview" id="commandPreview">create_ap wlan0 eth0 OrangePi-Hotspot</div>
                </div>

                <!-- Connected Clients -->
                <div class="panel" id="clientsPanel" style="display: none;">
                    <div class="panel-header">
                        <i data-lucide="users" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Connected Clients</h2>
                    </div>
                    <div class="client-list" id="clientList">
                        <div class="empty-state">
                            <i data-lucide="wifi-off" style="width: 48px; height: 48px; margin: 0 auto 12px;"></i>
                            <p>No clients connected yet</p>
                        </div>
                    </div>
                </div>

                <!-- Traffic Statistics -->
                <div class="panel" id="trafficPanel" style="display: none;">
                    <div class="panel-header">
                        <i data-lucide="bar-chart-2" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Traffic Statistics</h2>
                    </div>
                    <table class="stats-table">
                        <tr>
                            <td>WiFi Transmitted:</td>
                            <td id="wifiTx">0 B</td>
                        </tr>
                        <tr>
                            <td>WiFi Received:</td>
                            <td id="wifiRx">0 B</td>
                        </tr>
                        <tr>
                            <td>Internet Transmitted:</td>
                            <td id="ethTx">0 B</td>
                        </tr>
                        <tr>
                            <td>Internet Received:</td>
                            <td id="ethRx">0 B</td>
                        </tr>
                        <tr>
                            <td><strong>Total Traffic:</strong></td>
                            <td class="stats-total" id="totalTraffic">0 B</td>
                        </tr>
                    </table>
                </div>

                <!-- Logs -->
                <div class="panel">
                    <div class="panel-header">
                        <i data-lucide="scroll-text" style="color: #667eea; width: 24px; height: 24px;"></i>
                        <h2>Logs</h2>
                    </div>
                    <div class="logs-container" id="logsContainer">
                        <div style="color: #718096;">Initializing...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Box -->
        <div class="info-box">
            <p><strong>ðŸ’¡ Tips:</strong></p>
            <ul style="margin-top: 8px; padding-left: 20px; line-height: 1.8;">
                <li>This application requires <strong>root privileges</strong> (run with sudo)</li>
                <li>Configuration is <strong>automatically saved</strong> and restored on restart</li>
                <li>Use <strong>Daemon Mode</strong> to keep hotspot running after closing browser</li>
                <li>Enable <strong>IEEE 802.11n/ac</strong> for better performance on supported devices</li>
                <li>Set <strong>Country Code</strong> for proper regulatory compliance</li>
            </ul>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
